<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AccelerateTile.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">inkball_scaffold</a> &gt; <a href="index.source.html" class="el_package">inkball</a> &gt; <span class="el_source">AccelerateTile.java</span></div><h1>AccelerateTile.java</h1><pre class="source lang-java linenums">package inkball;

import processing.core.PImage;

/**
 * Represents an acceleration tile that speeds up the ball in a specific direction when it passes over.
 */
public class AccelerateTile extends Entity implements Drawable {
    PImage tileImage;        // The image representing the acceleration tile
    private String direction;        // The direction of acceleration (&quot;up&quot;, &quot;down&quot;, &quot;left&quot;, &quot;right&quot;)
    public static final float ACCELERATION_AMOUNT = 0.5f;  // Amount to accelerate the ball
    public static final float MAX_SPEED = 5.0f;           // Maximum speed limit
    public static final float MIN_SPEED = 0.0f;           // Minimum speed limit

    int width;
    int height;       // Dimensions of the tile (assuming 32x32 pixels)
    int collisionBuffer;     // Buffer to reduce frequent collision detection
    public static final int BUFFER_THRESHOLD = 10;        // Minimum frames between collision checks

    /**
     * Constructs an AccelerateTile object.
     *
     * @param x         The x-coordinate of the tile.
     * @param y         The y-coordinate of the tile.
     * @param direction The direction of acceleration (&quot;up&quot;, &quot;down&quot;, &quot;left&quot;, &quot;right&quot;).
     * @param p         The App instance used to load images.
     */
    public AccelerateTile(int x, int y, String direction, App p) {
<span class="fc" id="L29">        super(x, y, 0);  // color is not used for tiles, set to 0</span>

<span class="fc bfc" id="L31" title="All 2 branches covered.">        if (direction == null) {</span>
<span class="fc" id="L32">            throw new NullPointerException(&quot;Direction cannot be null&quot;);</span>
        }

<span class="fc" id="L35">        this.direction = direction;</span>
<span class="fc" id="L36">        this.width = 32;  // Assuming tile size 32x32</span>
<span class="fc" id="L37">        this.height = 32;</span>
<span class="fc" id="L38">        this.collisionBuffer = 0;</span>
<span class="fc" id="L39">        loadImage(p);</span>
<span class="fc" id="L40">    }</span>

    /**
     * Loads the image for the acceleration tile based on its direction.
     *
     * @param p The App instance used to load the image.
     */
    @Override
    public void loadImage(App p) {
<span class="fc" id="L49">        tileImage = p.loadImage(&quot;inkball/acceleration_&quot; + direction + &quot;.png&quot;);</span>
<span class="fc" id="L50">    }</span>

    /**
     * Checks for a collision between the ball and the acceleration tile.
     * If a collision is detected, applies acceleration to the ball in the tile's direction.
     *
     * @param ball The Ball object to check for collision and apply acceleration.
     */
    public void checkCollision(Ball ball) {
<span class="fc bfc" id="L59" title="All 2 branches covered.">        if (ball == null) {</span>
<span class="fc" id="L60">            throw new NullPointerException(&quot;Ball cannot be null&quot;);</span>
        }

<span class="fc" id="L63">        collisionBuffer++;  // Increment the collision buffer to prevent continuous detection</span>

        // Check collision only if buffer threshold is reached
<span class="fc bfc" id="L66" title="All 2 branches covered.">        if (collisionBuffer &gt;= BUFFER_THRESHOLD) {</span>
            // Check if the ball's bounding box intersects with the tile
<span class="fc bfc" id="L68" title="All 4 branches covered.">            if (ball.getX() + ball.getRadius() &gt; x &amp;&amp; ball.getX() - ball.getRadius() &lt; x + width &amp;&amp;</span>
<span class="fc bfc" id="L69" title="All 4 branches covered.">                    ball.getY() + ball.getRadius() &gt; y &amp;&amp; ball.getY() - ball.getRadius() &lt; y + height) {</span>

                // Apply acceleration based on direction
<span class="fc" id="L72">                applyAcceleration(ball);</span>

                // Reset the collision buffer after collision
<span class="fc" id="L75">                collisionBuffer = 0;</span>
            }
        }
<span class="fc" id="L78">    }</span>

    /**
     * Applies acceleration to the ball in the tile's direction.
     *
     * @param ball The Ball object to accelerate.
     */
    void applyAcceleration(Ball ball) {
<span class="fc bfc" id="L86" title="All 5 branches covered.">        switch (direction) {</span>
            case &quot;up&quot;:
                // Apply upward acceleration (decrease y velocity)
<span class="fc" id="L89">                ball.setYVelocity(ball.getYVelocity() - ACCELERATION_AMOUNT);</span>
                // Ensure velocity does not exceed MAX_SPEED or fall below MIN_SPEED
<span class="fc bfc" id="L91" title="All 2 branches covered.">                if (ball.getYVelocity() &lt; -MAX_SPEED) {</span>
<span class="fc" id="L92">                    ball.setYVelocity(-MAX_SPEED);</span>
                }
<span class="pc bpc" id="L94" title="1 of 2 branches missed.">                if (Math.abs(ball.getYVelocity()) &lt;= MIN_SPEED) {</span>
<span class="nc" id="L95">                    ball.setYVelocity(ball.getInitialYVelocity()); // Reset to initial velocity</span>
                }
                break;
            case &quot;down&quot;:
                // Apply downward acceleration (increase y velocity)
<span class="fc" id="L100">                ball.setYVelocity(ball.getYVelocity() + ACCELERATION_AMOUNT);</span>
<span class="fc bfc" id="L101" title="All 2 branches covered.">                if (ball.getYVelocity() &gt; MAX_SPEED) {</span>
<span class="fc" id="L102">                    ball.setYVelocity(MAX_SPEED);</span>
                }
<span class="pc bpc" id="L104" title="1 of 2 branches missed.">                if (Math.abs(ball.getYVelocity()) &lt;= MIN_SPEED) {</span>
<span class="nc" id="L105">                    ball.setYVelocity(ball.getInitialYVelocity()); // Reset to initial velocity</span>
                }
                break;
            case &quot;left&quot;:
                // Apply leftward acceleration (decrease x velocity)
<span class="fc" id="L110">                ball.setXVelocity(ball.getXVelocity() - ACCELERATION_AMOUNT);</span>
<span class="fc bfc" id="L111" title="All 2 branches covered.">                if (ball.getXVelocity() &lt; -MAX_SPEED) {</span>
<span class="fc" id="L112">                    ball.setXVelocity(-MAX_SPEED);</span>
                }
<span class="pc bpc" id="L114" title="1 of 2 branches missed.">                if (Math.abs(ball.getXVelocity()) &lt;= MIN_SPEED) {</span>
<span class="nc" id="L115">                    ball.setXVelocity(ball.getInitialXVelocity()); // Reset to initial velocity</span>
                }
                break;
            case &quot;right&quot;:
                // Apply rightward acceleration (increase x velocity)
<span class="fc" id="L120">                ball.setXVelocity(ball.getXVelocity() + ACCELERATION_AMOUNT);</span>
<span class="fc bfc" id="L121" title="All 2 branches covered.">                if (ball.getXVelocity() &gt; MAX_SPEED) {</span>
<span class="fc" id="L122">                    ball.setXVelocity(MAX_SPEED);</span>
                }
<span class="fc bfc" id="L124" title="All 2 branches covered.">                if (Math.abs(ball.getXVelocity()) &lt;= MIN_SPEED) {</span>
<span class="fc" id="L125">                    ball.setXVelocity(ball.getInitialXVelocity()); // Reset to initial velocity</span>
                }
                break;
            default:
<span class="fc" id="L129">                throw new IllegalArgumentException(&quot;Invalid acceleration direction: &quot; + direction);</span>
        }
<span class="fc" id="L131">    }</span>

    /**
     * Draws the acceleration tile at its current position on the screen.
     *
     * @param p The App instance used for drawing.
     */
    @Override
    public void draw(App p) {
<span class="fc" id="L140">        p.image(tileImage, x, y, width, height);</span>
<span class="fc" id="L141">    }</span>

    // Getter and setter for x
    public int getX() {
<span class="fc" id="L145">        return x;</span>
    }

    public void setX(int x) {
<span class="nc" id="L149">        this.x = x;</span>
<span class="nc" id="L150">    }</span>

    // Getter and setter for y
    public int getY() {
<span class="fc" id="L154">        return y;</span>
    }

    public void setY(int y) {
<span class="nc" id="L158">        this.y = y;</span>
<span class="nc" id="L159">    }</span>

    // Getter for direction
    public String getDirection() {
<span class="fc" id="L163">        return direction;</span>
    }

    // Setter for direction (optional if direction can change)
    public void setDirection(String direction) {
<span class="nc" id="L168">        this.direction = direction;</span>
<span class="nc" id="L169">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>